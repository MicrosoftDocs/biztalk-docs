---
description: "Learn more about: Sending an Outgoing MDN"
title: "Sending an Outgoing MDN"
ms.custom: ""
ms.date: "06/08/2017"
ms.service: biztalk-server
ms.reviewer: ""
ms.suite: ""
ms.topic: "article"
---
# Sending an Outgoing MDN
An outgoing MDN is generated by the AS2EDIReceive or AS2Receive receive pipeline, and sent by the AS2Send pipeline. This topic describes how an MDN is sent. For more information on how an MDN is generated, see [Generating an Outgoing MDN](../core/generating-an-outgoing-mdn.md).  
  
> [!NOTE]
>  The AS2EDISend send pipeline is not used to send an outgoing MDN, because the EDI assembler in that pipeline is not used in processing an MDN.  
  
## Agreement Resolution for an MDN  
 An MDN is self-routing. It contains the information that it needs to be routed to the intended agreement. The send pipeline uses the AS2 agreement properties to process the outgoing MDN. However, the MDN does not have to have an agreement resolved for it to be routed to the party.  
  
 When the AS2Send pipeline processes an outgoing MDN, it uses the AS2-To value in the message context to obtain the agreement properties to process the MDN. It does so by matching the AS2-To context property with the AS2-To agreement property in the **Identifiers** page in the one-way AS2 agreement tab in the **Agreement Properties** dialog box. This agreement resolution for the MDN can fail if the AS2-To value is not set for the agreement. If the agreement cannot be determined, a default agreement is used to generate the MDN.  
  
 In the default agreement for an outgoing MDN, the certificate resolution list verification is performed. If you do not want this verification to be performed, verify that the correct AS2-To agreement property is set, so the receiving party can be resolved and the agreement properties can be determined. If so, the default agreement that prompts verification of the certificate resolution list will not be used. You will also need to disable the **Check Certification Revocation List** property on the **Validation** page of the one-way AS2 agreement tab in the **Agreement Properties** dialog box.  
  
## Synchronous and Asynchronous Transmission  
 In default AS2 processing, an MDN is sent synchronously. The MDN is sent by the send port associated with a two-way receive port. [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] sends the MDN as an HTTP response to an HTTP POST or as an HTTPS response to an HTTPS POST, on the same TCP/IP connection. The MDN is included in the message body of the HTTP Response command.  
  
 If the MDN is being sent asynchronously, the MDN must be sent by a separate send port, which picks the MDN up from the MessageBox. [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] sends the MDN as a separate HTTP Post delivered on a unique TCP/IP connection, distinct from that used to deliver the original AS2 message. Even though the MDN is set as a separate HTTP Post, an HTTP Response command is still required for the Post.  
  
 An asynchronous MDN will normally be sent to the URL in the Receipt-Delivery-Option header of the original AS2 message. However, if the **Use agreement settings for validation and MDN instead of message header** property is set on the on the **Validation** page of the one-way AS2 agreement tab in the **Agreement Properties** dialog box, the MDN will be sent to the URL that the **Receipt-Delivery-Option (URL)** agreement property is set to.  
  
## How the Send Pipeline Processes an Outgoing MDN  
 The AS2Send pipeline processes an outgoing MDN are as follows:  
  
-   Performs MIME processing, including applying a digital signature, if enabled in the AS2 one-way agreement properties.  
  
-   Makes correlation entries in the non-repudiation database (the EdiMessageContent table of the BizTalkDTADb database).  
  
-   Makes a copy of the MDN (in wire format) and stores it in the non-repudiation database, if enabled in the **NRR enabled for outbound MDN** agreement property.  
  
-   Delivers the MDN to the HTTP adapter.  
  
## See Also  
 [How BizTalk Server Sends AS2 Messages](../core/how-biztalk-server-sends-as2-messages.md)   
 [AS2 Send Components](../core/as2-send-components.md)
