---
description: "Learn more about: How to Configure a Windows SharePoint Services Receive Location"
title: "How to Configure a Windows SharePoint Services Receive Location"
ms.custom: ""
ms.date: "06/08/2017"
ms.prod: "biztalk-server"
ms.reviewer: ""
ms.suite: ""
ms.topic: "article"
---
# How to Configure a Windows SharePoint Services Receive Location
This topic describes how to create and configure a Windows SharePoint Services receive location by using the BizTalk Server Administration Console.  

### To create and configure a Windows SharePoint Services receive location  

1. Ensure you have a receive port properly configured. For information about how to create and configure a receive port, see [How to Create a Receive Port](../core/how-to-create-a-receive-port.md).  

2. In the **BizTalk Server Administration console**, expand [!INCLUDE[btsBizTalkServer2006r3ui](../includes/btsbiztalkserver2006r3ui-md.md)] **Administration**, expand **BizTalk Group [GroupName]**, expand **Applications**, and then expand the application you want to create a receive location in.  

3. Right-click **Receive Locations**, click **New**, and then click **One-way Receive Location**.  

4. Select the receive port that will contain this receive location, and then click **OK**.  

5. In the **Receive Location Properties** dialog box, under **Transport**, in the **Type** drop-down box, select **Windows SharePoint Services**.  

6. Click **Configure**.  

7. In the **Windows SharePoint Services Transport Properties** dialog box, do the following:  


   |           Use this           |                                                                                                                                                                                                                                                                                                                                    To do this                                                                                                                                                                                                                                                                                                                                    |
   |------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |   Adapter Web Service Port   |                                                                                                                                                                      The HTTP port of the IIS Web site where the Windows SharePoint Services adapter Web service is installed. By default, this is the Default Web Site configured on port 80. If you have configured the Windows SharePoint Services Web service on any IIS Web site other than the Default Web Site, you will have to update this value.                                                                                                                                                                       |
   |           Timeout            |                                                                                                                                                                                                        The time-out, in milliseconds, for the adapter runtime Web service calls made to the Windows SharePoint Services adapter Web service. You may need to increase this value if the message or batch size is higher than the average that is expected by the adapter.                                                                                                                                                                                                        |
   |       Archive Filename       |                (Optional) The archived file Windows SharePoint Services file name. You can type in a literal value like 'PurchaseOrder0001.xml' or an expression. Expressions can include any mix of literals, macros, and XPATH queries. For example, "PurchOrd-%XPATH=//po:PurchaseOrderId%-%MessageID%.xml". When no file name is supplied the file name of source file is used. For more information about expressions, see [Windows SharePoint Services Adapter Expressions](../core/windows-sharepoint-services-adapter-expressions.md). **Note:**  The "%SendingOrchestrationID%" and "%SendingOrchestrationType%" macros are not supported by this field.                |
   |     Archive Location URL     |                                                                                                  The Windows SharePoint Services folder URL, relative to the SharePoint site, where the processed files are archived. For example, Archive or /Shared Documents/Processed Orders/. If an archive location is not specified, the document is deleted after being processed by the adapter. **Note:**  Sometimes the SharePoint document library, or folder URL is different from the name of that item. Check the address bar in Internet Explorer to discover the correct URL.                                                                                                   |
   |      Archive Overwrite       |                              Determines whether existing files in the archive are overwritten. Select "Yes" to overwrite existing files. Select "No" for the archive to fail if a file with the same name already exists in the archive. In this case the file will remain checked out and it will have to be archived manually. **Note:**  When archiving files, we recommend that you use Archive Filename values with macros in order to make the file name unique. For this purpose you could use an Archive Filename such as PO-%MessageID%.xml or PO-%XPATH=//ns0:PurchaseOrder/ns0:ID%.xml, where ID is the unique ID of the purchase order.                              |
   |          Batch Size          |                                                                                                                                                                                                              The maximum number of documents that the Windows SharePoint Services Messaging Adapter Web service will process as a batch. A processed batch might contain fewer messages than the defined batch size; however, it will never contain more messages.                                                                                                                                                                                                               |
   |       Error Threshold        |                                                                                                                                                                                                                                            The maximum number of consecutive polling failures encountered by the adapter until the receive location is disabled. Set this field to 0 in order to never disable the receive location.                                                                                                                                                                                                                                             |
   |      Namespaces Aliases      |                                                                                                                                                              (Optional) A comma or semicolon-delimited list of namespace aliases definitions. Use this field to define the namespace aliases that are used by the XPATH queries introduced in the Archive Filename field. For example, po=`'http://OrderProcess/POrder'`, conf=`'http://OrderProcess/Confirmation'` ipsol='{D8217CF1-4EF7-4bb5-A30D-765ECB09E0D9}'                                                                                                                                                               |
   |       Polling Interval       |                                                                                                                                                                                                                 The time interval, in seconds, between two consecutive queries performed by the adapter to see if any new messages are available for processing. **Note:**  Specifying a lower value improves the throughput and response time for the adapter.                                                                                                                                                                                                                  |
   |     SharePoint Site URL      |                                                                                                                                                                                                                                       The complete URL of the Windows SharePoint Services Web site. For example, http://BizTalkServer/sites/TestSite. **Note:**  The URI for a send port or receive location cannot exceed 256 characters.                                                                                                                                                                                                                                       |
   | Source Document Library URL  | This is the URL of the Windows SharePoint Services document library, relative to the SharePoint site, where the documents are retrieved. For example, /Shared Documents/ or /New Purchase Orders/. **Note:**  You cannot receive messages from a SharePoint list. You cannot receive messages from a SharePoint folder unless using a view which shows the messages in all folders. To do this you set the **Folders** property to a value of **Show all documents without folders** when creating a view. **Note:**  Sometimes the SharePoint document library is different from the name of that item. Check the address bar in Internet Explorer to discover the correct URL. |
   |          View Name           |                                                                            This is the Windows SharePoint Services view used to filter documents processed by the adapter. For example, Approved Orders. Leave this field empty to process all the existing documents in the source document library. Folders showing up in a view and the messages contained in those folders will not be processed by the adapter. You can create flat views that will show all documents in a flat structure including documents existing in subfolders. **Note:**  All messages in a flat view will be processed.                                                                            |
   | Microsoft Office Integration |                                                                                                                                                        "Optional" to attempt to remove InfoPath processing instructions if possible or to process as is if not possible (for instance, a binary document). Choose "Yes" to remove InfoPath processing instructions or to skip the message in case of an error. Choose "No" to process the document "as is." For binary messages, you must use “No” or “Optional” values.                                                                                                                                                         |


8. Click **OK**.  

## See Also  
 [How to Configure a Windows SharePoint Services Send Handler](../core/how-to-configure-a-windows-sharepoint-services-send-handler.md)   
 [How to Configure a Windows SharePoint Services Send Port](../core/how-to-configure-a-windows-sharepoint-services-send-port.md)   
 [How to Create a Send Port](../core/how-to-create-a-send-port2.md)   
 [Windows SharePoint Services Adapter Properties Reference](../core/windows-sharepoint-services-adapter-properties-reference.md)   
 [Windows SharePoint Services Adapter Expressions](../core/windows-sharepoint-services-adapter-expressions.md)   
 [Supported Windows SharePoint Services Column Types](../core/supported-windows-sharepoint-services-column-types.md)
