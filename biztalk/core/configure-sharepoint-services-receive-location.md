---
description: "Learn more about: Configure SharePoint Services Receive Location"
title: "Configure SharePoint Services Receive Location"
ms.custom: ""
ms.date: "06/08/2017"
ms.prod: "biztalk-server"
ms.reviewer: ""
ms.suite: ""
ms.topic: "article"
---
# Configure SharePoint Services Receive Location
This topic lists the steps to create a [!INCLUDE[btsWinSharePointSvcsNoVersion](../includes/btswinsharepointsvcsnoversion-md.md)] receive location.

## Create a Receive Location
 When creating a receive location, the receive location uses the default Receive Handler associated with Transport Type. When using the [!INCLUDE[btsWinSharePointSvcsNoVersion](../includes/btswinsharepointsvcsnoversion-md.md)] adapter, the default Receive Handler is **BizTalkServerApplication**. For the steps to add a new Receive Handler, go to [How to Create an Adapter Handler](https://go.microsoft.com/fwlink/p/?LinkId=263646).

 Create the Receive Location:

1. In the **BizTalk Server Administration** console, expand **BizTalk Group [*GroupName*]**, expand **Applications**, and then expand the application to contain the receive location.

2. Create a **One-way Receive Port**. [How to Create a Receive Port](../core/how-to-create-a-receive-port.md) lists the steps.

   > [!IMPORTANT]
   >  A **Request Response Receive Location** is not configurable with the [!INCLUDE[btsWinSharePointSvcsNoVersion](../includes/btswinsharepointsvcsnoversion-md.md)] adapter.

    Additional Receive Port configuration options include:

    [How to Add a Receive Location to a Receive Port](../core/how-to-add-a-receive-location-to-a-receive-port.md): A receive location is added in the next step.

    [How to Configure Inbound Maps for a Receive Port](../core/how-to-configure-inbound-maps-for-a-receive-port.md)

    [How to Configure Tracking for a Receive Port](../core/how-to-configure-tracking-for-a-receive-port.md)

3. Click **OK** to save the settings.

4. Right-click **Receive Locations**, click **New**, and then click **One-way Receive Location**.

   > [!IMPORTANT]
   >  A **Request Response Receive Location** is not configurable with the [!INCLUDE[btsWinSharePointSvcsNoVersion](../includes/btswinsharepointsvcsnoversion-md.md)] adapter.

5. Select the receive port and then click **OK**.

6. In  **Properties**, enter the **Name** and **pipeline** properties. In the **Type** drop-down list, click **Windows SharePoint Services** and select the **Receive Handler** property.

7. Click **Configure**. In  **Properties**, configure the following:


   |    Property                          |    Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
   |------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |   Adapter Web Service Port   |                                                                                                                                                                                                                                                                                                                                   **Required**. The port configured on the IIS web site hosting the [!INCLUDE[btsSharePointSvcsNoVersion](../includes/btssharepointsvcsnoversion-md.md)] adapter web service.<br /><br /> Default is port **80**, which is the standard HTTP port. Update this value if a port other than 80 is used.                                                                                                                                                                                                                                                                                                                                    |
   |           Timeout            |                                                                                                                                                                                                                                                                                                                                                    **Required**. In milliseconds, this value determine the time when the adapter receives a response from the web service.<br /><br /> Default is **100000 ms** (100 seconds).<br /><br /> Increase this value if the message or batch size is higher than expected.                                                                                                                                                                                                                                                                                                                                                     |
   |        Use Client OM         | **Required**. Determines whether the SharePoint Client Side Object Model (CSOM) or the Service Side Object Model (SSOM) is used.<br /><br /> Default is **Yes**. Set to **Yes** to use the SharePoint CSOM on the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]. There are no requirements on the [!INCLUDE[btsSharePointSvcsNoVersion](../includes/btssharepointsvcsnoversion-md.md)] computer.<br /><br /> Set to **No** to use the SharePoint SSOM that includes the web service installed on the [!INCLUDE[btsSharePointSvcsNoVersion](../includes/btssharepointsvcsnoversion-md.md)] computer.<br /><br /> [Appendix B: Install the Microsoft SharePoint Adapter](../install-and-config-guides/appendix-b-install-the-microsoft-sharepoint-adapter.md) provides specific information on the SSOM and CSOM components used by the [!INCLUDE[btsSharePointSvcsNoVersion](../includes/btssharepointsvcsnoversion-md.md)] adapter. |
   |       Archive Filename       |                                                                                                 **Optional**. The [!INCLUDE[btsSharePointSvcsNoVersion](../includes/btssharepointsvcsnoversion-md.md)] web services can archive documents from a SharePoint library. Enter the name of the archived file.<br /><br /> Enter a file name, like **PurchaseOrder0001.xml** or an expression. Expressions include any mix of literals, macros, and XPATH queries. For example, "PurchOrd-%XPATH=//po:PurchaseOrderId%-%MessageID%.xml". When no file name is supplied, the file name of the source file is used. See [Windows SharePoint Services Adapter Expressions](../core/windows-sharepoint-services-adapter-expressions.md) for more information. **Note:**  The "%SendingOrchestrationID%" and "%SendingOrchestrationType%" macros are not supported by this field.                                                                                                  |
   |     Archive Location URL     |                                                                                                                                                                                                                       **Optional**. The [!INCLUDE[btsSharePointSvcsNoVersion](../includes/btssharepointsvcsnoversion-md.md)] folder URL to store the archived documents. Enter the relative path to the SharePoint site. For example, **Archive** or **/Shared Documents/Processed Orders/**. If an archive location is not specified, the document is deleted after processed by the adapter. **Note:**  The SharePoint document library or folder URL can be different from its name. Check the address in the web browser for the correct URL.                                                                                                                                                                                                                        |
   |      Archive Overwrite       |                                                                                                                                                                                                                                  **Required**. Specify to overwrite existing files.<br /><br /> Default is **No**, which fails the archive if a file with the same name exists in the archive. In this scenario, the file is checked out and must be manually archived. **Note:**  When archiving files, use Archive Filename values with macros the file name is unique. For example, use an Archive Filename such as **PO-%MessageID%.xml or PO-%XPATH=//ns0:PurchaseOrder/ns0:*ID*%.xml**, where ID is the unique purchase order ID.                                                                                                                                                                                                                                  |
   |          Batch Size          |                                                                                                                                                                                                                                                                                                                                                **Required**. The maximum number of documents processed by the web service as a batch. A processed batch may contain fewer messages than the defined batch size. It does not contain more messages.<br /><br /> Default is **20** and must have a value of at least **1**.                                                                                                                                                                                                                                                                                                                                                |
   |       Error Threshold        |                                                                                                                                                                                                                                                                                                                                                                       **Required**. The maximum number of consecutive polling failures by the adapter until the receive location is disabled.<br /><br /> Default is **10**. To stop the receive location from being disabled, set this to **0**.                                                                                                                                                                                                                                                                                                                                                                        |
   |      Namespaces Aliases      |                                                                                                                                                                                                                                                                                           **Optional**. A comma or semicolon-delimited list of namespace aliases definitions.<br /><br /> Use this field to define the namespace aliases used by the XPATH queries introduced in the Archive Filename field listed above. For example, enter **po=`'http://OrderProcess/POrder'`, conf=`'http://OrderProcess/Confirmation'` ipsol='{D8217CF1-4EF7-4bb5-A30D-765ECB09E0D9}'**.                                                                                                                                                                                                                                                                                            |
   |       Polling Interval       |                                                                                                                                                                                                                                                                                                                                               **Required**. In seconds, the time between two consecutive queries executed by the adapter waiting for new messages.<br /><br /> Default is **60** and must have a value of at least **1**. **Note:**  To improve adapter throughput and response time, enter a lower value.                                                                                                                                                                                                                                                                                                                                               |
   |     SharePoint Site URL      |                                                                                                                                                                                                                                                                                                                                                **Optional**. The complete URL of the [!INCLUDE[btsSharePointSvcsNoVersion](../includes/btssharepointsvcsnoversion-md.md)] web site. For example, http:// *SharePointServer*/sites/TestSite. **Note:**  A send port or receive location URI cannot exceed 256 characters.                                                                                                                                                                                                                                                                                                                                                 |
   | Source Document Library URL  |                                                                                                                                                                                                                                                                                        **Optional**. The URL relative path of the [!INCLUDE[btsSharePointSvcsNoVersion](../includes/btssharepointsvcsnoversion-md.md)] document library where the documents are retrieved. For example, **/Shared Documents/** or **/New Purchase Orders/**. **Note:**  The SharePoint document library can be different from its name. Check the address in the web browser for the correct URL.                                                                                                                                                                                                                                                                                        |
   |          View Name           |                                                                                                                                                                                                                              **Optional**. the [!INCLUDE[btsSharePointSvcsNoVersion](../includes/btssharepointsvcsnoversion-md.md)] view used to filter documents processed by the adapter. For example, **Approved Orders**.<br /><br /> To process all the existing documents in the Source Document Library, leave this field empty. Folders in a view and the messages in those folders are not be processed by the adapter. Create flat views that show all documents in a flat structure, including documents existing in subfolders.                                                                                                                                                                                                                              |
   | Microsoft Office Integration |                                                                                                                                                                                                   **Required**. For binary messages, you must use “No” or “Optional” values.<br /><br /> Default is **Optional**.<br /><br /> Options include:<br /><br /> -   **No**: Processes the document “as is”. For binary messages, this option can be used.<br />-   **Optional**: Tries to remove InfoPath processing instructions. If the processing instructions aren’t removed, the document is processed “as is”. For binary messages, this option can be used.<br />-   **Yes**: Removes InfoPath processing instructions. If an error occurs, the message is skipped.                                                                                                                                                                                                    |
   |  SharePoint Online Password  |                                                                                                                                                                                                                                                                                                                                                                                                                                                      **Optional**. The password for the SharePoint online account.                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |  SharePoint Online Username  |                                                                                                                                                                                                                                                                                                                                                                                                                                                      **Optional**. The username for the SharePoint online account.                                                                                                                                                                                                                                                                                                                                                                                                                                                       |


8. Click **OK** save the settings.

9. Additional Receive Location configuration options include:

     [How to Configure Scheduling for a Receive Location](../core/how-to-configure-scheduling-for-a-receive-location.md)

10. Click **OK** save the settings.

    Additional Receive Port and Receive Location topics:

    [Managing Receive Ports](../core/managing-receive-ports.md)

    [Managing Receive Locations](../core/managing-receive-locations.md)

    Next, create a [!INCLUDE[btsSharePointSvcsNoVersion](../includes/btssharepointsvcsnoversion-md.md)] Send Port:

    [Configure SharePoint Services Send Port](../core/configure-sharepoint-services-send-port.md)

## See Also
 [Configure SharePoint Services Send Port](../core/configure-sharepoint-services-send-port.md)
 [Troubleshooting SharePoint Services Adapter](../core/troubleshooting-sharepoint-services-adapter.md)
 [CSOM: SharePoint Services Adapter](../core/csom-sharepoint-services-adapter.md)
