---
title: "WCF-BasicHttpRelay Adapter | Microsoft Docs"
ms.custom: ""
ms.date: "06/08/2017"
ms.prod: "biztalk-server"
ms.reviewer: ""

ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "article"
ms.assetid: 22eefde6-80f5-4d45-80cf-55f743ff9d45
caps.latest.revision: 5
author: "MandiOhlinger"
ms.author: "mandia"
manager: "anneta"
---
# WCF-BasicHttpRelay Adapter
[!INCLUDE[btsCoName](../includes/btsconame-md.md)] [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] uses the **WCF-BasicHttpRelay** adapter to receive and send WCF service requests through the [BasicHttpRelayBinding class](https://msdn.microsoft.com/library/azure/microsoft.servicebus.basichttprelaybinding.aspx). The **WCF-BasicHttpRelay** adapter uses Service Bus relay endpoints using the **BasicHttpRelayBinding**.  

## Before you begin

Starting with [!INCLUDE[bts2016_md](../includes/bts2016-md.md)], this adapter can use Access Control Service (ACS) or the Shared Access Signature (SAS) to athenticate with Service Bus. We recommend using the Shared Access Signature (SAS) when authenticating with Service Bus. 

When you create a Service Bus namespace, the Access Control (ACS) namespace is not automatically created. If you use ACS to authenticate, then you may need to create a new ACS namespace. See [SB-Messaging adapter](../core/sb-messaging-adapter.md) for more detailed information, including the steps to retrieve the ACS key values.
  
## Create the receive location
  
> [!NOTE]
>  Before completing the following procedure, you must have already added a one-way receive port. See [How to Create a Receive Port](../core/how-to-create-a-receive-port.md).  
  
1.  In the BizTalk Server Administration console, expand [!INCLUDE[btsBizTalkServerAdminConsoleui](../includes/btsbiztalkserveradminconsoleui-md.md)], expand **BizTalk Group**, expand **Applications**, and then expand the application under you want to create a receive location.  
  
2.  In the left pane, click the **Receive Ports** node and in the right pane, right-click the receive port with which you want to associate the new receive location, and then click **Properties**.  
  
3.  In the left pane of the **Receive Port Properties** dialog box, select **Receive Locations**, and in the right pane click **New** to create a new receive location.  
  
4.  In the **Receive Location Properties** dialog box, in the **Transport** section, select **WCF-BasicHttpRelay** from the **Type** drop-down list, and then click **Configure** to configure the transport properties for the receive location.  
  
5.  In the **WCF-BasicHttpRelay Transport Properties** dialog box, on the **General** tab, configure the endpoint address where the Service Bus relay endpoint is hosted and the service identity for the WCF-BasicHttpRelay receive location.  
  
    |Use this|To do this|  
    |--------------|----------------|  
    |**Address (URI)**|Required. Specify the URI where the Service Bus relay endpoint is deployed.|  
    |**Endpoint Identity**|Optional. Specify the endpoint identity. These settings enable the endpoint to authenticate this receive location. In the handshake process between the endpoint and the receive location, the Windows Communication Foundation (WCF) infrastructure will ensure that the identity of the expected service matches the values of this element.<br /><br /> The default is an empty string.|  
  
6.  In the **WCF-BasicHttpRelay Transport Properties** dialog box, on the **Binding** tab, configure the time-out and encoding-related properties.  
  
    |Use this|To do this|  
    |--------------|----------------|  
    |**Open timeout (hh:mmss)**|Specify a time span value that indicates the interval of time provided for a channel open operation to complete. This value should be greater than or equal to **System.TimeSpan.Zero**.<br /><br /> Default value: 00:01:00<br /><br /> Maximum value:  23:59:59|  
    |**Send timeout (hh:mmss)**|Specify a time span value that indicates the interval of time provided for a send operation to complete. This value should be greater than or equal to **System.TimeSpan.Zero**. If you use a request-response receive port, this value specifies a time span for the whole interaction to complete, even if the client returns a large message.<br /><br /> Default value: 00:01:00<br /><br /> Maximum value:  23:59:59|  
    |**Close timeout (hh:mmss)**|Specify a time span value that indicates the interval of time provided for a channel close operation to complete. This value should be greater than or equal to **System.TimeSpan.Zero**.<br /><br /> Default value: 00:01:00<br /><br /> Maximum value:  23:59:59|  
    |**Maximum received message size (bytes)**|Specify the maximum size, in bytes, for a message including headers, which can be received on the wire. The size of the messages is bounded by the amount of memory allocated for each message. You can use this property to limit exposure to denial of service (DoS) attacks.<br /><br /> The WCF-BasicHttpRelay adapter leverages the [BasicHttpRelayBinding](http://msdn.microsoft.com/library/windowsazure/microsoft.servicebus.basichttprelaybinding.aspx) class in the buffered transfer mode to communicate with an endpoint. For the buffered transport mode, the [BasicHttpRelayBinding.MaxBufferSize](http://msdn.microsoft.com/library/windowsazure/microsoft.servicebus.basichttprelaybinding.maxbuffersize.aspx) property is always equal to the value of this property.<br /><br /> Default value: 65536<br /><br /> Maximum value: 2147483647|  
    |**Message encoding**|Specify the encoder used to encode the SOAP message. Valid values include the following:<br /><br /> -   **Text**: Use a text message encoder.<br />-   **Mtom**: Use a Message Transmission Organization Mechanism 1.0 (MTOM) encoder.<br /><br /> The default is **Text**.|  
    |**Text encoding**|Specify the character set encoding to be used for emitting messages on the binding when the **Message encoding** property is set to **Text**. Valid values include the following:<br /><br /> -   **utf-16BE (unicodeFFFE)**: Unicode BigEndian encoding.<br />-   **utf-16**: 16-bit encoding.<br />-   **utf-8**: 8-bit encoding<br /><br /> The default is **utf-8**.|  
    |**Max concurrent calls**|Specify the number of concurrent calls to a single service instance. Calls in excess of the limit are queued. Setting this value to 0 is equivalent to setting it to **Int32.MaxValue**.<br /><br /> The default is 200.|  
  
7.  In the **WCF-BasicHttpRelay Transport Properties** dialog box, on the **Security** tab, define the security capabilities of the WCF-BasicHttpRelay receive location.  
  
    |Use this|To do this|  
    |--------------|----------------|  
    |**Security mode**|Specify the type of security that is used. Valid values include the following:<br /><br /> -   **None**: Messages are not secured during transfer.<br />-   **Transport**: Security is provided using the HTTPS transport. The SOAP messages are secured using HTTPS. To use this mode, you must set up Secure Sockets Layer (SSL) in Microsoft Internet Information Services (IIS).<br />-   **Message**: Security is provided using SOAP message security over the HTTP transport. By default, the SOAP **Body** is encrypted and signed. The only valid **Message client credential type** for the WCF-Basic adapter is **Certificate**. This mode requires the HTTP transport. When using this security mode, the service certificate for this receive location needs to be provided through the **Service certificate - Thumbprint** property.<br />-   **TransportWithMessageCredential**: Integrity, confidentiality, and service authentication are provided by the HTTPS transport. To use this mode, you must set up Secure Sockets Layer (SSL) in Microsoft Internet Information Services (IIS).<br /><br /> The default is **Transport**.|  
    |**Message client credential type**|Specify the message-level security options only if you set the **Security mode** above to **Message** or **TransportWithMessageCredential**. Valid values include the following:<br /><br /> -   **UserName**: Enables this receive location to require that clients be authenticated using the **UserName** credential. You must create the domain or local user accounts corresponding to the client credentials.<br />-   **Certificate**: Clients are authenticated to this receive location using the client certificate. The CA certificate chain for the client X.509 certificates must be installed in the Trusted Root Certification Authorities certificate store of this computer so that the clients can be authenticated to this receive location.<br /><br /> The default is **UserName**.|  
    |**Algorithm suite**|Specify the message encryption and key-wrap algorithms only if you set the **Security mode** mode above to **Message** or **TransportWithMessageCredential**. This is not applicable if you set the **Security mode** to **None** or **Transport**.<br /><br /> These algorithms map to those specified in the Security Policy Language (WS-SecurityPolicy) specification. Possible values are:<br /><br /> -   **Basic128**: Use Aes128 encryption, Sha1 for message digest, and Rsa-oaep-mgf1p for key wrap.<br />-   **Basic128Rsa15**: Use Aes128 for message encryption, Sha1 for message digest, and Rsa15 for key wrap.<br />-   **Basic128Sha256**: Use Aes256 for message encryption, Sha256 for message digest, and Rsa-oaep-mgf1p for key wrap.<br />-   **Basic128Sha256Rsa15**: Use Aes128 for message encryption, Sha256 for message digest, and Rsa15 for key wrap.<br />-   **Basic192**: Use Aes192 encryption, Sha1 for message digest, and Rsa-oaep-mgf1p for key wrap.<br />-   **Basic192Rsa15**: Use Aes192 for message encryption, Sha1 for message digest, and Rsa15 for key wrap.<br />-   **Basic192Sha256**: Use Aes192 for message encryption, Sha256 for message digest, and Rsa-oaep-mgf1p for key wrap.<br />-   **Basic192Sha256Rsa15**: Use Aes192 for message encryption, Sha256 for message digest, and Rsa15 for key wrap.<br />-   **Basic256**: Use Aes256 encryption, Sha1 for message digest, and Rsa-oaep-mgf1p for key wrap.<br />-   **Basic256Rsa15**: Use Aes256 for message encryption, Sha1 for message digest, and Rsa15 for key wrap.<br />-   **Basic256Sha256**: Use Aes256 for message encryption, Sha256 for message digest, and Rsa-oaep-mgf1p for key wrap.<br />-   **Basic256Sha256Rsa15**: Use Aes256 for message encryption, Sha256 for message digest, and Rsa15 for key wrap.<br />-   **TripleDes**: Use TripleDes encryption, Sha1 for message digest, Rsa-oaep-mgf1p for key wrap.<br />-   **TripleDesRsa15**: Use TripleDes encryption, Sha1 for message digest, and Rsa15 for key wrap.<br />-   **TripleDesSha256**: Use TripleDes for message encryption, Sha256 for message digest, and Rsa-oaep-mgf1p for key wrap.<br />-   **TripleDesSha256Rsa15**: Use TripleDes for message encryption, Sha256 for message digest, and Rsa15 for key wrap.<br /><br /> The default value is **Basic256**.|  
    |**Service certificate -Thumbprint**|Specify the thumbprint of the X.509 certificate for this receive location that the clients use to authenticate the service. The thumbprint can be selected by navigating the **My** store in the **Current User** location with the **Browse** button. **Note:**  You must set this property only if you set the **Security mode** mode above to **Message** or **TransportWithMessageCredential**. This is not applicable if you set the **Security mode** to **None** or **Transport**. **Note:**  You must install the service certificate into the **Current User** location of the user account for the receive handler hosting this receive location. <br /><br /> Minimum length: 0<br /><br /> Maximum length: 40<br /><br /> The default is an empty string.|  
    |**Relay client authentication type**|Specify the option to authenticate with the Service Bus relay endpoint from where the message is received. Valid values include the following:<br /><br /> -   **None**: No authentication is required.<br />-   **RelayAccessToken**: Specify this to use a security token to authorize with the Service Bus Relay endpoint.<br /><br /> The default value is **RelayAccessToken**.|  
    |**Enable service discovery**|Select this check box to specify whether the behavior of the service is published in the Service Registry.<br /><br /> -   **Display name** – Specify the name with which the service is published to the Service Registry.<br />-   **Discovery mode** – Set the discovery mode for the service published in the Service Registry. For more information about the discovery modes, see [http://msdn.microsoft.com/library/microsoft.servicebus.discoverytype.aspx](http://msdn.microsoft.com/library/microsoft.servicebus.discoverytype.aspx).|  
    |**Access control service**|Applies to [!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)] and [!INCLUDE[btsBizTalkServerNoVersion_md](../includes/btsbiztalkservernoversion-md.md)] 2013.<br/><br/>If you set the **Relay client authentication type** to **RelayAccessToken**, click the **Edit** button and specify the following details:<br /><br /> -   **Access Control Service STS Uri** – Set this to `https://<Namespace>-sb.accesscontrol.windows.net/`, where \<namespace\> is your Service Bus namespace.<br />-   **Issuer Name** – Specify the issuer name. Typically this is set to owner.<br />-   **Issuer Key** – Specify the issuer key.|  
    |**Service Bus connection information** | New starting with [!INCLUDE[bts2016_md](../includes/bts2016-md.md)].<br/><br/>Choose to use the Shared Access Signature (SAS) or Access Control Service (ACS) of the Service Bus namespace. <br/><br/>Select an option, and then select **Edit** to enter the key information:<br/><br/> - **Shared Access Signature** : Enter the access key name, and the access key. Both values are listed in the [Azure portal](https://portal.azure.com).<br/> - **Access Control Service** : Enter the STS URI (`https://<yourNamespace>-sb.accesscontrol.windows.net/`), Issuer name, and Issuer key. Use Windows PowerShell to retrieve these values, as described in [SB-Messaging adapter](../core/sb-messaging-adapter.md). |
  
8.  In the **WCF-BasicHttpRelay Transport Properties** dialog box, on the **Messages** tab, specify the data selection for the SOAP **Body** element.  
  
    |Use this|To do this|  
    |--------------|----------------|  
    |**Envelope -- entire \<soap:Envelope\>**|Create the BizTalk message body part from the entire SOAP **Envelope** of an incoming message.<br /><br /> The default value is cleared.|  
    |**Body -- contents of \<soap:Body\> element**|Use the content of the SOAP **Body** element of an incoming message to create the BizTalk message body part. If the **Body** element has more than one child element, only the first element becomes the BizTalk message body part.<br /><br /> This is the default setting.|  
    |**Path -- content located by body path**|Use the body path expression in the **Body path expression** text box to create the BizTalk message body part. The body path expression is evaluated against the immediate child element of the SOAP **Body** element of an incoming message.<br /><br /> The default value is cleared.|  
    |**Body path expression**|Type the body path expression to identify a specific part of an incoming message used to create the BizTalk message body part. This body path expression is evaluated against the immediate child element of the SOAP **Body** element of an incoming message. If this body path expression returns more than one node, only the first node is chosen for the BizTalk message body part. This property is required if the **Path -- content located by body path** option is selected.<br /><br /> Type: String<br /><br /> Minimum length: 0<br /><br /> Maximum length: 32767<br /><br /> The default is an empty string.|  
    |**Node encoding**|Specify the type of encoding that the WCF-BasicHttpRelay receive adapter uses to decode the node identified by the body path expression in the **Body path expression** text box.<br /><br /> This property is required if the **Path -- content located by body path** option is selected. Valid values include the following:<br /><br /> -   **Base64**: Base64 encoding.<br />-   **Hex**: Hexadecimal encoding.<br />-   **String**: Text encoding - UTF-8<br />-   **XML**: The WCF adapters create the BizTalk message body with the outer XML of the node selected by the body path expression in the **Body path expression** text box.<br /><br /> The default is **XML**.|  
    |**Body -- BizTalk response message body**|Use the BizTalk message body part to create the content of the SOAP **Body** element of an outgoing response message. This property is valid only for request-response receive locations.<br /><br /> This is the default setting.|  
    |**Template -- content specified by template**|Use the template supplied in the **XML** text box to create the content of the SOAP **Body** element for an outgoing message. This property is valid only for request-response receive locations.<br /><br /> The default value is cleared.|  
    |**XML**|Type the XML-formatted template for the content of the SOAP **Body** element of an outgoing message. This property is required if the **Template -- BizTalk response message body** option is selected. This property is valid only for request-response receive locations.<br /><br /> Type: String<br /><br /> Minimum length: 0<br /><br /> Maximum length: 32767<br /><br /> The default is **\<bts-msg-body xmlns="http://www.microsoft.com/schemas/bts2007" encoding="xml"\>**.|  
    |**Suspend request message on failure**|Specify whether to suspend the request message that fails inbound processing due to a receive pipeline failure or a routing failure.<br /><br /> The default value is cleared.|  
    |**Include exception detail in faults**|Specify whether to return SOAP faults when an error occurs to easy debugging.<br /><br /> The default value is cleared.|  
  
9. Click **OK**.  
  
10. Enter the appropriate values in the **Receive Location Properties** dialog box to complete the configuration of the receive location and click **OK** to save settings. For information about the **Receive Locations Properties** dialog box, see [How to Create a Receive Location](../core/how-to-create-a-receive-location.md).  

## Create the send port

1.  In the BizTalk Administration console, create a new send port or double-click an existing send port to modify it. See [How to Create a Send Port](../core/how-to-create-a-send-port2.md). Configure all of the send port options and specify **WCF-BasicHttpRelay** for the **Type** option in the **Transport** section of the **General** tab.  
  
2.  On the **General** tab, in the **Transport** section, click the **Configure** button.  
  
3.  In the **WCF-BasicHttpRelay Transport Properties** dialog box, on the **General** tab, specify the following:  
  
    |Use this|To do this|  
    |--------------|----------------|  
    |**Address (URI)**|Required. Specify the URL where the relay endpoint is deployed on the Service Bus. Typically the URL is in the following format:<br /><br /> `https://<namespace>.servicebus.windows.net/`|  
    |**Endpoint Identity**|Optional. Specify the endpoint identity. These settings enable this send port to authenticate with the endpoint. In the handshake process between the end point and the send port, the Windows Communication Foundation (WCF) infrastructure will ensure that the endpoint identity matches the values of this element.<br /><br /> The default value is cleared.|  
    |**Action**|Specify the **SOAPAction** HTTP header field for outgoing messages. This property can also be set through the message context property **WCF.Action** in a pipeline or orchestration. You can specify this value in two different ways: the single action format and the action mapping format. If you set this property in the single action format- for example, `http://contoso.com/Svc/Op1`- the **SOAPAction** header for outgoing messages is always set to the value specified in this property.<br /><br /> If you set this property in the action mapping format, the outgoing **SOAPAction** header is determined by the **BTS.Operation** context property. For example, if this property is set to the following XML format and the **BTS.Operation** property is set to Op1, the WCF send adapter uses `http://contoso.com/Svc/Op1` for the outgoing **SOAPAction** header.<br /><br /> `<BtsActionMapping> <Operation Name="Op1" Action="http://contoso.com/Svc/Op1" /> <Operation Name="Op2" Action="http://contoso.com/Svc/Op2" /> </BtsActionMapping>`<br /><br /> If outgoing messages comes from an orchestration port, orchestration instances dynamically set the **BTS.Operation** property with the operation name of the port. If outgoing messages are routed with content-based routing, you can set the **BTS.Operation** property in pipeline components.<br /><br /> Important:<br /><br /> [!INCLUDE[sb](../includes/sb-md.md)] mandates that a SOAP action be set when sending messages to relay endpoints.<br /><br /> Minimum length: 0<br /><br /> Maximum length: 32767<br /><br /> The default is an empty string.|  
  
4.  In the **WCF-BasicHttpRelay Transport Properties** dialog box, on the **Binding** tab, configure the time-out and encoding properties.  
  
    |Use this|To do this|  
    |--------------|----------------|  
    |**Open timeout (hh:mmss)**|Specify a time span value that indicates the interval of time provided for a channel open operation to complete. This value should be greater than or equal to **System.TimeSpan.Zero**.<br /><br /> Default value: 00:01:00<br /><br /> Maximum value:  23:59:59|  
    |**Send timeout (hh:mmss)**|Specify a time span value that indicates the interval of time provided for a send operation to complete. This value should be greater than or equal to **System.TimeSpan.Zero**. If you use a solicit-response send port, this value specifies a time span for the whole interaction to complete, even if the service returns a large message.<br /><br /> Default value: 00:01:00<br /><br /> Maximum value:  23:59:59|  
    |**Close timeout (hh:mmss)**|Specify a time span value that indicates the interval of time provided for a channel close operation to complete. This value should be greater than or equal **System.TimeSpan.Zero**.<br /><br /> Default value: 00:01:00<br /><br /> Maximum value:  23:59:59|  
    |**Maximum received message size (bytes)**|Specify the maximum size, in bytes, for a message including headers, which can be received on the wire. The size of the messages is bounded by the amount of memory allocated for each message. You can use this property to limit exposure to denial of service (DoS) attacks.<br /><br /> The WCF-BasicHttpRelay adapter leverages the [BasicHttpBinding](http://go.microsoft.com/fwlink/?LinkId=81086) class in the buffered transfer mode to communicate with an endpoint. For the buffered transport mode, the [BasicHttpBinding.MaxBufferSize](http://go.microsoft.com/fwlink/?LinkId=80659) property is always equal to the value of this property.<br /><br /> Default value: 65536<br /><br /> Maximum value: 2147483647|  
    |**Message encoding**|Specify the encoder used to encode the SOAP message. Valid values include the following:<br /><br /> -                         **Text**: Use a text message encoder.<br /><br /> -                         **Mtom**: Use a Message Transmission Organization Mechanism 1.0 (MTOM) encoder.<br /><br /> Default value: **Text**|  
    |**Text encoding**|Specify the character set encoding to be used for emitting messages on the binding when the **Message encoding** property is set to **Text**. Valid values include the following:<br /><br /> -                         **utf-16BE (unicodeFFFE)**: Unicode BigEndian encoding.<br /><br /> -                         **utf-16**: 16-bit encoding.<br /><br /> -                         **utf-8**: 8-bit encoding<br /><br /> Default value: **utf-8**|  
  
5.  In the **WCF-BasicHttpRelay Transport Properties** dialog box, on the **Security** tab, define the security capabilities of the WCF-BasicHttpRelay send port.  
  
    |Use this|To do this|  
    |--------------|----------------|  
    |**Security mode**|Specify the type of security that is used. Valid values include the following:<br /><br /> -                         **None**: Messages are not secured during transfer.<br /><br /> -                         **Transport**: Security is provided using the HTTPS transport. The SOAP messages are secured using HTTPS. The CA certificate chain for the service's X.509 certificate must be installed in the Trusted Root Certification Authorities certificate store of this computer so that the service can be authenticated to the send port using the service's certificate.<br /><br /> -                         **Message**: Security is provided using SOAP message security. By default, the SOAP **Body** element is encrypted and signed. The only valid **Message client credential type** for the WCF-BasicHttpRelay send adapter is **Certificate**. This mode requires the HTTP transport.<br /><br /> -                         **TransportWithMessageCredential**: Integrity, confidentiality, and service authentication are provided by the HTTPS transport. The CA certificate chain for the service's X.509 certificate must be installed in the Trusted Root Certification Authorities certificate store on this computer so that the service can be authenticated to the send port using the service's certificate. The send port authentication is provided by SOAP message security.<br /><br /> The default is **None**.|  
    |**Message client credential type**|Specify the message-level security options only if you set the **Security mode** above to **Message** or **TransportWithMessageCredential**. Valid values include the following:<br /><br /> -                         **UserName**: This send port is authenticated to the endpoint with a **UserName** credential. For the WCF-BasicHttpRelay send adapter, this is not supported.<br /><br /> -                         **Certificate**: This send port is authenticated to endpoint using the client certificate specified through the **Client certificate - Thumbprint** property. In addition, when using this credential type, the service certificate needs to be provided through the **Service certificate - Thumbprint** property.<br /><br /> The default is **UserName**.|  
    |**Algorithm suite**|Specify the message encryption and key-wrap algorithms. These algorithms map to those specified in the Security Policy Language (WS-SecurityPolicy) specification. Possible values are:<br /><br /> -                         **Basic128**: Use Aes128 encryption, Sha1 for message digest, and Rsa-oaep-mgf1p for key wrap.<br /><br /> -                         **Basic128Rsa15**: Use Aes128 for message encryption, Sha1 for message digest, and Rsa15 for key wrap.<br /><br /> -                         **Basic128Sha256**: Use Aes256 for message encryption, Sha256 for message digest, and Rsa-oaep-mgf1p for key wrap.<br /><br /> -                         **Basic128Sha256Rsa15**: Use Aes128 for message encryption, Sha256 for message digest, and Rsa15 for key wrap.<br /><br /> -                         **Basic192**: Use Aes192 encryption, Sha1 for message digest, and Rsa-oaep-mgf1p for key wrap.<br /><br /> -                         **Basic192Rsa15**: Use Aes192 for message encryption, Sha1 for message digest, and Rsa15 for key wrap.<br /><br /> -                         **Basic192Sha256**: Use Aes192 for message encryption, Sha256 for message digest, and Rsa-oaep-mgf1p for key wrap.<br /><br /> -                         **Basic192Sha256Rsa15**: Use Aes192 for message encryption, Sha256 for message digest, and Rsa15 for key wrap.<br /><br /> -                         **Basic256**: Use Aes256 encryption, Sha1 for message digest, and Rsa-oaep-mgf1p for key wrap.<br /><br /> -                         **Basic256Rsa15**: Use Aes256 for message encryption, Sha1 for message digest, and Rsa15 for key wrap.<br /><br /> -                         **Basic256Sha256**: Use Aes256 for message encryption, Sha256 for message digest, and Rsa-oaep-mgf1p for key wrap.<br /><br /> -                         **Basic256Sha256Rsa15**: Use Aes256 for message encryption, Sha256 for message digest, and Rsa15 for key wrap.<br /><br /> -                         **TripleDes**: Use TripleDes encryption, Sha1 for message digest, Rsa-oaep-mgf1p for key wrap.<br /><br /> -                         **TripleDesRsa15**: Use TripleDes encryption, Sha1 for message digest, and Rsa15 for key wrap.<br /><br /> -                         **TripleDesSha256**: Use TripleDes for message encryption, Sha256 for message digest, and Rsa-oaep-mgf1p for key wrap.<br /><br /> -                         **TripleDesSha256Rsa15**: Use TripleDes for message encryption, Sha256 for message digest, and Rsa15 for key wrap.<br /><br /> The default value is **Basic256**.|  
    |**Client certificate -  Thumbprint**|Specify the thumbprint of the X.509 certificate for authenticating this send port to the endpoint. You can select the thumbprint by navigating to the **My** store in the **Current User** location with the **Browse** button.<br /><br /> Note:<br /><br /> You must install the client certificate into the **Current User** location of the user account for the send handler hosting this send port.<br /><br /> Minimum length: 0<br /><br /> Maximum length: 40<br /><br /> The default is an empty string.|  
    |**Service certificate - Thumbprint**|Specify the thumbprint of the X.509 certificate for authenticating the endpoint to which this send port sends messages. You can select the thumbprint navigating to the **Other People** store in the **Local Machine** location with the **Browse** button.<br /><br /> Minimum length: 0<br /><br /> Maximum length: 40<br /><br /> The default is an empty string.|  
    |**User name credentials**|Specify the credentials for sending messages. You can specify the property by clicking the **Edit** button. You must set the credentials if you selected the **Username** option for **Message client credential type**.<br /><br /> The default value is **Do not use Single Sign-On**.|  
    |**Use ACS service identity**|Applies to [!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)] and [!INCLUDE[btsBizTalkServerNoVersion_md](../includes/btsbiztalkservernoversion-md.md)] 2013.<br/><br/>Select this checkbox and click **Edit** and provide the following values to authenticate with the Service Bus.<br /><br /> -                         **Access Control Service STS Uri** – Set this to `https://<Namespace>-sb.accesscontrol.windows.net/`, where \<namespace\> is your Service Bus namespace.<br /><br /> -                         **Issuer Name** – Specify the issuer name. Typically this is set to owner.<br /><br /> -                         **Issuer Key** – Specify the issuer key.|  
    |**Service Bus connection information** | New starting with [!INCLUDE[bts2016_md](../includes/bts2016-md.md)].<br/><br/>Choose to use the Shared Access Signature (SAS) or Access Control Service (ACS) of the Service Bus namespace. <br/><br/>Select an option, and then select **Edit** to enter the key information:<br/><br/> - **Shared Access Signature** : Enter the access key name, and the access key. Both values are listed in the [Azure portal](https://portal.azure.com).<br/> - **Access Control Service** : Enter the STS URI (`https://<yourNamespace>-sb.accesscontrol.windows.net/`), Issuer name, and Issuer key. Use Windows PowerShell to retrieve these values, as described in [SB-Messaging adapter](../core/sb-messaging-adapter.md). |
  
6.  In the **WCF-BasicHttpRelay Transport Properties** dialog box, on the **Proxy** tab, configure the proxy setting for the WCF-BasicHttpRelay send port.  
  
    |Use this|To do this|  
    |--------------|----------------|  
    |**Use Send handler proxy settings**|Specify whether this send port uses the proxy settings in the send handler hosting this send port.<br /><br /> This is the default setting.|  
    |**Do not use proxy**|Indicate whether this send port uses a proxy server.<br /><br /> The default value is cleared.|  
    |**Use proxy**|Indicate whether this send port uses the proxy server specified in the **Address** property.<br /><br /> The default value is cleared.|  
    |**Address**|Specify the address of the proxy server. Use the **https** or the **http** scheme depending on the security configuration. This address can be followed by a colon and the port number. For example, http://127.0.0.1:8080.<br /><br /> This property requires a value only if **Use proxy** is selected.<br /><br /> Type: String<br /><br /> Maximum length: 256<br /><br /> The default is an empty string.|  
    |**User name**|Specify the user name to use for authentication. If integrated authentication is used, the user name includes the domain, that is, domain\username. If Basic or Digest authentication is used, the user name does not include domain\\. This property requires a value only if **Use proxy** is selected.<br /><br /> Note:<br /><br /> The WCF-BasicHttpRelay send adapter uses the basic authentication for the proxy.<br /><br /> Type: String<br /><br /> Minimum length: 0<br /><br /> Maximum length: 256<br /><br /> The default is an empty string.|  
    |**Password**|Specify the password to use for authentication.<br /><br /> This property requires a value only if **Use proxy** is selected.<br /><br /> Type: String<br /><br /> Minimum length: 0<br /><br /> Maximum length: 256<br /><br /> The default is an empty string.|  
  
7.  In the **WCF-BasicHttpRelay Transport Properties** dialog box, on the **Messages** tab, specify the data selection for the SOAP **Body** element.  
  
    |Use this|To do this|  
    |--------------|----------------|  
    |**Body -- BizTalk request message body**|Use the BizTalk message body part to create the content of the SOAP **Body** element for an outgoing message.<br /><br /> This is the default setting.|  
    |**Template -- content specified by template**|Use the template supplied in the **XML** text box to create the content of the SOAP **Body** element for an outgoing message.<br /><br /> The default value is cleared.|  
    |**XML**|Type the XML-formatted template for the content of the SOAP  **ody** element of an outgoing message. This property is required if the **Template -- BizTalk response message body** option is selected.<br /><br /> Type: String<br /><br /> Minimum length: 0<br /><br /> Maximum length: 32767<br /><br /> The default is `<bts-msg-body xmlns="http://www.microsoft.com/schemas/bts2007" encoding="xml"/>`.|  
    |**Envelope -- entire \<soap:Envelope\>**|Create the BizTalk message body part from the entire SOAP **Envelope** of an incoming message. This property is valid only for solicit-response ports.<br /><br /> The default value is cleared.|  
    |**Body -- contents of \<soap:Body\> element**|Use the content of the SOAP **Body** element of an incoming message to create the BizTalk message body part. If the **Body** element has more than one child element, only the first element becomes the BizTalk message body part. This property is valid only for solicit-response ports.<br /><br /> This is the default setting.|  
    |**Path -- content located by body path**|Use the body path expression in the **Body path expression** text box to create the BizTalk message body part. The body path expression is evaluated against the immediate child element of the SOAP **Body** element of an incoming message. This property is valid only for solicit-response ports.<br /><br /> The default value is cleared.|  
    |**Body path expression**|Type the body path expression to identify a specific part of an incoming message used to create the BizTalk message body part. This body path expression is evaluated against the immediate child element of the SOAP **Body** node of an incoming message. If this body path expression returns more than one node, only the first node is chosen for the BizTalk message body part. This property is required if the **Path -- content located by body path** option is selected. This property is valid only for solicit-response ports.<br /><br /> Type: String<br /><br /> Minimum length: 0<br /><br /> Maximum length: 32767<br /><br /> The default is an empty string.|  
    |**Node encoding**|Specify the type of encoding that the WCF-BasicHttpRelay send adapter uses to decode for the node identified by the body path expression in the **Body path expression** text box. This property is required if the **Path -- content located by body path** option is selected. This property is valid only for solicit-response ports. Valid values include the following:<br /><br /> - **Base64**: Base64 encoding.<br /><br /> -                         **Hex**: Hexadecimal encoding.<br /><br /> -                         **String**: Text encoding - UTF-8<br /><br /> -                         **XML**: The WCF adapters create the BizTalk message body with the outer XML of the node selected by the body path expression in the **Body path expression** text box.<br /><br /> The default is **XML**.|  
    |**Propagate fault message**|Select this check box to route the message that fails outbound processing to a subscribing application (such as another receive port or orchestration schedule). Clear the check box to suspend failed messages and generate a negative acknowledgment (NACK). This property is valid only for solicit-response ports.<br /><br /> The default value is selected.|  
  
8.  Click **OK** and **OK** again to save settings.  
  
## Add a proxy to the send handler

You can add a proxy to the send port, or the send handler. If you are adding a proxy at the send port, then skip this section.

1.  In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration Console, expand [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration, expand **BizTalk Group**, expand **Platform Settings**, and then expand **Adapters**.  
  
2.  Select **WCF-BasicHttpRelay**, and then select the send handler.  
  
3.  In **Adapter Handler Properties**, on the **General** tab, select **Properties**.  
  
4.  In the **Proxy** tab, do the following.  
  
    |Use this|To do this|  
    |--------------|----------------|  
    |**Use proxy**|Indicate whether this send handler uses a proxy server.<br /><br /> The default value is cleared.|  
    |**Address**|Specify the address of the proxy server. Use the **https** or the **http** scheme depending on the security configuration. This address can be followed by a colon and the port number. For example, http://127.0.0.1:8080.<br /><br /> This property requires a value only if **Use proxy** is selected.<br /><br /> Type: String<br /><br /> Maximum length: 256<br /><br /> The default is an empty string.|  
    |**User name**|Specify the user name to use for authentication. If integrated or Basic authentication is used, the user name includes the domain, that is, domain\username. If Digest authentication is used, the user name does not include domain\\.<br /><br /> This property requires a value only if **Use proxy** is selected.<br /><br /> Type: String<br /><br /> Minimum length: 0<br /><br /> Maximum length: 256<br /><br /> The default is an empty string.|  
    |**Password**|Specify the password to use for authentication.<br /><br /> This property requires a value only if **Use proxy** is selected.<br /><br /> Type: String<br /><br /> Minimum length: 0<br /><br /> Maximum length: 256<br /><br /> The default is an empty string.|  
  
5.  Click **OK** until you exit all the dialog boxes.  
  
## See Also  
[SB-Messaging adapter](../core/sb-messaging-adapter.md)

[Using Adapters](../core/using-adapters.md)