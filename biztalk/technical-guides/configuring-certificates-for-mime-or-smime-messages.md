---
title: "Configuring Certificates for MIME or SMIME Messages | Microsoft Docs"
ms.custom: ""
ms.date: "06/29/2017"
ms.prod: "biztalk-server"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "article"
ms.assetid: ea6e5481-fc2e-4b17-b6c8-1ec5d2bfa2c3
caps.latest.revision: 4
author: "MandiOhlinger"
ms.author: "mandia"
manager: "anneta"
---
# Configuring Certificates for MIME or SMIME Messages
To help secure data transfer on [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], you must associate certificates installed in the certificate stores with the appropriate BizTalk artifacts. This applies to MIME/SMIME-encoded messages. It also applies to AS2 transport, which transports MIME/SMIME messages.  
  
 Use the following table as a reference for the certificate usage scenarios and configuration options available in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]. Detailed procedures are provided in the topics listed in the "In This Section" heading at the end of this topic.  
  
|**Certificate Usage**|**User Context**|**Certificate Store Location**|**Certificate Type**|**Configuration Parameters in the BizTalk Administration Console**|  
|---------------------------|----------------------|------------------------------------|--------------------------|------------------------------------------------------------------------|  
|Encryption (Sending)|Account used by the host instance associated with the send handler|Log on to each computer running [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] that will host S/MIME encoder pipelines and import the encryption certificate into the **Local Computer \ Other People** store.|Trading partner public certificate|-   Specify values for the encryption certificate **Common Name** and **Thumbprint** on the **Certificate** page of the **Send Port Properties** dialog box.<br />-   Specify pipeline **Encode** options in the **Configure Pipeline** dialog box. The **Configure Pipeline** dialog box is displayed by clicking the button next to the **Send pipeline** drop-down list on the **General** page of the **Send Port Properties** dialog box.|  
|Decryption (Receiving)|Account used by the host instance associated with the receive handler|Log on to each computer running [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] that will host S/MIME decoder pipelines as each host instance service account, and import the decryption certificate to the **Current User \ Personal** store. **Note:**  For pipeline decryption to succeed on computers running IIS 6.0 or later, ensure that the account for the IIS application pool and the account used by the host instance associated with the receive handler are the same and that this account is a member of the \<*machineName*\>\IIS_WPG group. For more information about setting IIS process identity for IIS see [Guidelines for Resolving IIS Permissions Problems](http://go.microsoft.com/fwlink/?LinkId=155161) (http://go.microsoft.com/fwlink/?LinkId=155161) in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Help. These processes must run under the same account to ensure that the account profile is loaded which in turns loads the registry keys required to perform decryption in the pipeline. For performance reasons, IIS does not load the account profile when starting the associated w3wp.exe process so the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] host instance must be configured with the same account so that [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will load the account profile and registry keys.|Own private certificate|-   Specify values for the decryption certificate **Common Name** and **Thumbprint** on the **Certificates** page of each **Host Properties** dialog box.<br />-   Specify pipeline **Decode** options in the **Configure Pipeline** dialog box. The **Configure Pipeline** dialog box is displayed by clicking the button next to the **Receive pipeline** drop-down list on the **General** page of the **Receive Location Properties** dialog box.|  
|Signature (Sending)|Account used by the host instance associated with the send handler|Log on to each computer running [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] that will host S/MIME encoder pipelines as each host instance service account, and import the signature certificate to the **Current User \ Personal** store.|Own private certificate|-   Specify values for the signature certificate **Common Name** and **Thumbprint** on the **Certificate** page of the **BizTalk Group Properties** dialog box. **Note:**      Only one signature certificate can be specified per each [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] group.<br />-   Specify pipeline **Encode** options in the **Configure Pipeline** dialog box. The **Configure Pipeline** dialog box is displayed by clicking the button next to the **Send pipeline** drop-down list on the **General** page of the **Send Port Properties** dialog box.|  
|Signature Verification (Receiving)|Account used by the host instance associated with the receive handler|Log on to each computer running [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] that will host S/MIME decoder pipelines and import the signature certificate to the **Local Computer \ Other People** store.|Trading partner public certificate|-   Specify values for the verification certificate **Common Name** and **Thumbprint** on the **Certificates** page of each **Party Properties** dialog box.<br />-   Specify pipeline **Decode** options in the **Configure Pipeline** dialog box. The **Configure Pipeline** dialog box is displayed by clicking the button next to the **Receive pipeline** drop-down list on the **General** page of the **Receive Location Properties** dialog box. **Note:**      The certificate used to verify a signature for a party must be unique from the certificates used to verify signatures for other parties. **Note:**      Configuration of the **Decode** option requires that a pipeline with the MIME/SMIME decoder component is deployed.|  
|Party Resolution (Receiving)|Account used by the host instance associated with the receive handler|Log on to the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer from which party resolution is being configured, and import the certificate into the **Local Computer \ Other People** store.|Trading partner public certificate|-   Specify values for the certificate **Common Name** and **Thumbprint** on the **Certificates** page of each **Host Properties** dialog box.<br />-   Specify **ResolveParty** options in the **Configure Pipeline** dialog box. The **Configure Pipeline** dialog box is displayed by clicking the button next to the **Receive pipeline** drop-down list on the **General** page of the **Receive Location Properties** dialog box. **Note:**      Configuration of this option requires the use of a pipeline that contains the **Party resolution** component. The **XMLReceive** pipeline contains the **Party resolution** component.|  
|HTTPS (Sending)|Account used by the host instance associated with the send handler|SSL communication does not require a client certificate. Whether a client certificate is required is at the discretion of the destination Web server administrator. If the destination Web server requires a client certificate then follow these steps:<br /><br /> -   Obtain the public certificate from the trading partner.<br />-   Log on to each computer running [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] as the account used by the host instance associated with the send handler.<br />-   Import the certificate into the **Current User \ Personal** store.<br /><br /> For information about configuring IIS to use SSL, see the Knowledge Base article [HOW TO: Install Imported Certificates on a Web Server in Windows Server 2003](http://go.microsoft.com/fwlink/?LinkId=155162) (http://go.microsoft.com/fwlink/?LinkId=155162).<br /><br /> For information about how to obtain a certificate using Windows Server 2003 Certificate Services Web pages, see [Use Windows Server 2003 Certificate Services Web Pages](http://go.microsoft.com/fwlink/?LinkID=69975) (http://go.microsoft.com/fwlink/?LinkID=69975). **Note:**  To use the Certificate Services Web page to obtain certificates from a Windows Server 2008 computer, see the Microsoft Knowledge Base article 922706 at [http://go.microsoft.com/fwlink/?LinkId=155317](http://go.microsoft.com/fwlink/?LinkId=155317) (http://go.microsoft.com/fwlink/?LinkId=155317).|Trading partner public certificate|-   **HTTP Transport** - Set the **SSL client certificate thumbprint** option on the **Authentication** tab of the **HTTP Transport Properties** dialog box. The **HTTP Transport Properties** dialog box is displayed by clicking the **Configure** button on the **General** page of the **Send Port Properties** dialog box.<br />-   **SOAP Transport** - Set the **Client certificate thumbprint** option on the **General** tab of the **SOAP Transport Properties** dialog box. The **SOAP Transport Properties** dialog box is displayed by clicking the **Configure** button on the **General** page of the **Send Port Properties** dialog box.|  
  
## In This Section  
  
-   [How to Configure BizTalk Server to Receive Encrypted MIME or SMIME Messages](../technical-guides/how-to-configure-biztalk-server-to-receive-encrypted-mime-or-smime-messages.md)  
  
-   [How to Configure BizTalk Server to Send Encrypted MIME or SMIME Messages](~/technical-guides/how-to-configure-biztalk-server-to-send-encrypted-mime-smime-messages.md)  
  
-   [How to Configure BizTalk Server to Receive Signed MIME or SMIME Messages](../technical-guides/how-to-configure-biztalk-server-to-receive-signed-mime-or-smime-messages.md)  
  
-   [How to Configure BizTalk Server to Send Signed MIME or SMIME Messages](../technical-guides/how-to-configure-biztalk-server-to-send-signed-mime-or-smime-messages.md)